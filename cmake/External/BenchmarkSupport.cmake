set( BENCHMARK_VERSION "1.8.2")
set( PROJECT_NAME "benchmark")

ExternalProject_Add(
    ${PROJECT_NAME}
    PREFIX ${FETCHCONTENT_BASE_DIR}/${PROJECT_NAME}
    GIT_REPOSITORY      https://github.com/google/benchmark.git
    GIT_TAG             "v${BENCHMARK_VERSION}"
    SOURCE_DIR "${FETCHCONTENT_BASE_DIR}/${PROJECT_NAME}/${PROJECT_NAME}-${BENCHMARK_VERSION}/src"
    BINARY_DIR "${FETCHCONTENT_BASE_DIR}/${PROJECT_NAME}/${PROJECT_NAME}-${BENCHMARK_VERSION}/build"
    INSTALL_DIR "${FETCHCONTENT_BASE_DIR}/${PROJECT_NAME}/${PROJECT_NAME}-${BENCHMARK_VERSION}/install"
    CMAKE_ARGS
    -DCMAKE_INSTALL_PREFIX:PATH=<INSTALL_DIR>
    -DCMAKE_BUILD_TYPE=Release
    -DBENCHMARK_ENABLE_GTEST_TESTS=OFF
    -DBENCHMARK_ENABLE_LTO=ON
    -DBENCHMARK_DOWNLOAD_DEPENDENCIES=ON
    -DCXXFEATURECHECK_DEBUG=ON
	-DCMAKE_DEBUG_POSTFIX=-d
)

list(APPEND DEPENDENCIES ${PROJECT_NAME})

set(benchmark_DIR "${FETCHCONTENT_BASE_DIR}/${PROJECT_NAME}/${PROJECT_NAME}-${BENCHMARK_VERSION}/install/lib/cmake/benchmark")

set(BENCHMARK_INSTALL_DIR "${FETCHCONTENT_BASE_DIR}/${PROJECT_NAME}/${PROJECT_NAME}-${BENCHMARK_VERSION}/install/")

list(APPEND EXTRA_CMAKE_ARGS
    -Dbenchmark_DIR:PATH=${benchmark_DIR}
)